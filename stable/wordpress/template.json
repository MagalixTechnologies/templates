{
	"name": "wordpress",
	"description": "This template describes how to run a persistent installation of WordPress and MySQL on Magalix. We'll use the mysql and wordpress official Docker images for this installation. (The WordPress image includes an Apache server).",
	"target_cloud": {
		"type": "aws",
		"region": "us-east-1",
		"zone": "us-east-1a"
	},
	"labels": [{
		"label": "environment",
		"value": "dev"
	}, {
		"label": "app",
		"value": "wordpress"
	}],
	"services": [{
		"name": "wordpress-mysql",
		"description": "This service hosts my sql database, which uses a persistent volume for DB data",
		"resources": {
			"replicas": 1
		},
		"restart": "always",
		"labels": [{
			"label": "environment",
			"value": "dev"
		}, {
			"label": "app",
			"value": "wordpress"
		}, {
			"label": "role",
			"value": "mysql"
		}],
		"ports": [{
			"is_public": false,
			"target_port": "mysql",
			"is_websocket": false,
			"port": 3306
		}],
		"containers": [{
			"name": "mysql",
			"description": "Master container of the redis cache ",
			"resources": {
				"vcpu": 4,
				"memory": 8192,
				"io": 100,
				"icu": 28
			},
			"image_url": "mysql:5.7",
			"ports": [{
				"name": "mysql",
				"container_port": 3306
			}],
			"environment": [{
				"name": "MYSQL_ROOT_PASSWORD",
				"value": "password!"
			}],
			"labels": [{
				"label": "environment",
				"value": "dev"
			}, {
				"label": "role",
				"value": "master"
			}],
			"commands": [],
			"volume_mounts": [{
				"mount_path": "/var/lib/mysql",
				"name": "mysql-db"
			}]
		}]
	}, {
		"name": "wordpress",
		"description": "wordpress service (includes Apache)",
		"resources": {
			"replicas": 2
		},
		"restart": "always",
		"labels": [{
			"label": "environment",
			"value": "dev"
		}, {
			"label": "app",
			"value": "wordpress"
		}],
		"ports": [{
			"is_public": true,
			"target_port": "http-server",
			"is_websocket": false,
			"port": 80,
			"kpi_policy": "wordpress"
		}],
		"containers": [{
			"name": "wordpress",
			"description": "wordpress container, includes apache",
			"resources": {
				"vcpu": 4,
				"memory": 8192,
				"io": 100,
				"icu": 56
			},
			"image_url": "wordpress:latest",
			"ports": [{
				"name": "http-server",
				"container_port": 80
			}],
			"environment": [{
				"name": "WORDPRESS_DB_HOST",
				"value": "wordpress-mysql"
			}, {
				"name": "WORDPRESS_DB_PASSWORD",
				"value": "password!"
			}],
			"labels": [{
				"label": "environment",
				"value": "dev"
			}, {
				"label": "app",
				"value": "wordpress"
			}],
			"commands": [],
			"volume_mounts": [{
				"mount_path": "/var/www/html",
				"name": "wordpress-persistent-storage"
			}]
		}]
	}],
	"volumes": [{
		"name": "mysql-db",
		"access_mode": "ReadWriteOnce",
		"size": 20,
		"persistent": true,
		"labels": []
	}, {
		"name": "wordpress-persistent-storage",
		"access_mode": "ReadWriteOnce",
		"size": 20,
		"persistent": true,
		"labels": []
	}],
	"kpi_policies": [{
		"name": "wordpress",
		"definition": {
			"max_latency": "800ms"
		}
	}]
}